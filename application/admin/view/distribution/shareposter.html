<!DOCTYPE HTML>
<html>
{include file='layout/head' /}
<style>
#share_image_content{
    display:block;
    width:270px;
    min-height:300px;
    border:1px solid red;
    background:url('/public/shareposter/temp/poster_image.png') no-repeat 50% 50%;
    position: absolute;
    left: 60%;
    top: 70px;
}
.preview{
    width:300px;
    height:auto;
    min-height: 300px;
    border: 1px solid rgb(245, 223, 223);
    position: absolute;
    left: 50%;
    top: 150px;
    z-index: 999;
    background: rgba(245, 242, 242, 0.521);
}
.preview_default{
    width:100%;
    height:auto;
    line-height: 200px;
    text-align: center;
    font-size: 24px;
    color:burlywood;
    background: #FFF;
}
</style>
<body>
	<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 分销管理 <span
			class="c-gray en">&gt;</span> 分享海报 <a class="btn btn-success radius r replace"
			style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新"><i
				class="Hui-iconfont">&#xe68f;</i></a></nav>
<div class="page-container">
    <p style="color:red;margin-left:10%;">下面设置栏“宽”“高”“X”“Y”“字体大小”等请填写整数</p>
	<form class="form form-horizontal" method="POST" enctype="multipart/form-data" target="ajaxR">
		<div id="tab-system" class="HuiTab">
			<div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">背景图片：</label>
                    <div class="formControls col-xs-8 col-sm-9"> 
                        <a class="btn btn-success show_file">上传背景图片</a>
                        <p>点击预览查看最新图片效果</p>
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">二维码 * 宽：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="w" id="code_width" value="{$config.w ? $config.w : 75}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">二维码 * 高：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="h" id="code_height" value="{$config.h ? $config.h : 75}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">二维码 * X：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="code_x" id="code_x" value="{$config.x ? $config.x : 0}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">二维码 * Y：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="code_y" id="code_y" value="{$config.y ? $config.y : 0}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">用户名称 * X：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="name_x" id="name_x" value="{$config.name_x ? $config.name_x : 0}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">用户名称 * Y：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="name_y" id="name_y" value="{$config.name_y ? $config.name_y : 0}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">用户名称字体大小：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="name_font_size" id="name_font_size" value="{$config.name_font_size ? $config.name_font_size : 20}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">用户名称字体颜色：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="color" class="input-text" name="name_font_color" id="name_font_color" value="{$config.name_font_color ? $config.name_font_color : ''}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">标语：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="title" id="title" value="{$config.title ? $config.title : '一起来赚钱！'}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">标语 * X：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="title_x" id="title_x" value="{$config.title_x ? $config.title_x : 0}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">标语 * Y：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="title_y" id="title_y" value="{$config.title_y ? $config.title_y : 0}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">标语字体大小：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="text" class="input-text" name="title_font_size" id="title_font_size" value="{$config.title_font_size ? $config.title_font_size : 20}">
                    </div>
                </div>
                <div class="row cl">
                    <label class="form-label col-xs-4 col-sm-2">标语字体颜色：</label>
                    <div class="formControls col-xs-8 col-sm-3"> 
                        <input type="color" class="input-text" name="title_font_color" id="title_font_color" value="{$config.title_font_color ? $config.title_font_color : ''}">
                    </div>
                </div>

                <div class="row cl" style="margin-top:100px;">
                    <div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-2">
                        <button onClick="submit_preview()" class="btn btn-primary radius" type="button"><i class="Hui-iconfont">&#xe709;</i> 预览</button>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <button class="btn btn-primary radius" type="submit"><i class="Hui-iconfont">&#xe632;</i> 保存</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
    <div class="preview">
        <img id="preview-image" alt="海报预览" class="preview_default" style="display:block;" src="{$poster_path}" />
    </div>
    <iframe name="ajaxR" style="display:none;width:100%;height:300px"></iframe>
    <form id="ajaxR_form" style="display: none;" action="/admin/distribution/silence_image" method="POST" enctype="multipart/form-data" target="Aj_Iframe">
        <input type="text" name="t" value="temp_image">
        <input type="file" name="image" id="aj_temp_file" value="" >
    </form>
    <iframe style="display:none;" id="Aj_Iframe" name="Aj_Iframe"></iframe>
</div>
{include file='layout/footer' /}
<script>
$(function(){
    $('.show_file').on('click',function(){
        $('#aj_temp_file').click();
    });
    $('#aj_temp_file').on('change',function(){
        var file_path = $('#aj_temp_file').val();
        $('#text-file').val(file_path);
        $('#ajaxR_form').submit();
    });
})

function submit_preview(){
    var w = $('#code_width').val();
    var h = $('#code_height').val();
    var x = $('#code_x').val();
    var y = $('#code_y').val();
    var name_x = $('#name_x').val();
    var name_y = $('#name_y').val();
    var name_font_size = $('#name_font_size').val();
    var name_font_color = $('#name_font_color').val();
    var title = $('#title').val();
    var title_x = $('#title_x').val();
    var title_y = $('#title_y').val();
    var title_font_size = $('#title_font_size').val();
    var title_font_color = $('#title_font_color').val();
    var src = "{$poster_path}";

    $.post("/admin/distribution/silence_image",{t:'preview',w:w, h:h, x:x, y:y,name_x:name_x,name_y:name_y,name_font_size:name_font_size,name_font_color:name_font_color,title:title,title_x:title_x,title_y:title_y,title_font_size:title_font_size,title_font_color:title_font_color},function(res){
        
        if(res.status == 1){
            $('.preview_default').css('display','none');
            $('#preview-image').css('display','block');
            src = src+'?'+res.time;
            $('#preview-image').attr('src',src);
        }else{
            layer.msg(res.msg);
        }
    });
}
</script>
</body>